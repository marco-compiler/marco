import sys
import lit.util

from lit.llvm import llvm_config

if "runtime-library" not in config.available_features:
    config.unsupported = True

# Allow only one simulation at a time.
config.singleProcess = True

# The flags to pass to the linker when compiling a model.
link_flags = []

# MPI.
if ("runtime-mpi" in config.available_features):
    link_flags.append(config.marco_runtime_mpi_cxx_link_flags)

    for lib in config.marco_runtime_mpi_cxx_libraries.split():
        if os.path.isfile(lib):
            link_flags.append(lib)
        else:
            link_flags.append("-l " + lib)

config.substitutions.append(('%link_flags', ' '.join(link_flags)))
